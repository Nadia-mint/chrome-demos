<!DOCTYPE html>
<html>
<head>
<meta http-equiv="Content-Type" content="text/html; charset=ISO-8859-1">
<title>getUserMedia() -> ImageCapture demo</title>
</head>

<body>
<div> Open the system camera and grab frame(s) or take (a) picture(s).</div>
</body>

<script type="text/javascript" src="dimsum.js"></script>
<script>

var theStream;
var theImageCapturer;

function gotStream(stream) {
  theStream = stream;
  const videoTagId = 'videotag';
  createVideoTag(videoTagId, 240, 180, stream);
  document.getElementById("btn-capture").disabled = false;
}
createButton("btn1", "320x240", makeGetStreamX(320, 240, "btn1", gotStream));
document.body.appendChild(document.createElement("br"));


function createImageCapturer() {
  theImageCapturer = new ImageCapture(theStream.getVideoTracks()[0]);
  document.getElementById("btn-capture").disabled = true;
  document.getElementById("btn-frame").disabled = false;
}

function takePhoto() {
  theImageCapturer.takePhoto().then(function(a) { console.log(" photo taken" + a);});
}

function grabFrame() {
  theImageCapturer.grabFrame().then(function(a) { console.log(" frame grabbed" + a);});
}

createButton("btn-capture", "Create ImageCapturer", createImageCapturer);
document.getElementById("btn-capture").disabled = true;
createButton("btn-frame", "grabFrame()", grabFrame);
document.getElementById("btn-frame").disabled = true;
createButton("btn-photo", "takePhoto", takePhoto);
document.getElementById("btn-photo").disabled = true;

document.body.appendChild(document.createElement("br"));


</script>
</html>
